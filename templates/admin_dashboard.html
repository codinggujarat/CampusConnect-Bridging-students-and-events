<!DOCTYPE html>
<html>

<head>
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f6f8fa;
            color: #333;
        }
    </style>
</head>

<body>
    {% include "sidebar.html" %}

    <div class="main-content">
        <h2 class="fw-bold mb-4">Dashboard</h2>

        <div class="row mb-4">
            <div class="col-md-3">
                <div class="stat-card">
                    <div class="stat-title">Total Students Present</div>
                    <div class="stat-value">{{ total_present }}</div>
                    <div class="stat-change">↑ from last month</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stat-card">
                    <div class="stat-title">Total Students Absent</div>
                    <div class="stat-value">{{ total_absent }}</div>
                    <div class="stat-change" style="color:#e63946;">↑ from last month</div>
                </div>
            </div>
        </div>

        <h4 class="fw-bold mb-3">Semester-wise Attendance</h4>
        <div class="row">
            {% for sem, stats in sem_stats.items() %}
            <div class="col-md-4 mb-3">
                <div class="sem-card">
                    <h6>Semester {{ sem }}</h6>
                    <p class="present">Present: <strong>{{ stats.present }}</strong></p>
                    <p class="absent">Absent: <strong>{{ stats.absent }}</strong></p>
                </div>
            </div>
            {% endfor %}
        </div>
        <h2>Semester-wise Registrations</h2>
        <canvas id="semesterChart" width="400" height="200"></canvas>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        fetch("/chart_data")
            .then(res => res.json())
            .then(data => {
                const ctx = document.getElementById('semesterChart').getContext('2d');
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: data.labels,
                        datasets: [{
                            label: 'Registrations',
                            data: data.values,
                            backgroundColor: 'rgba(54, 162, 235, 0.6)'
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: { beginAtZero: true }
                        }
                    }
                });
            });
    </script>

</body>

</html>