{% extends "sidebar.html" %}
{% block title %}Scan Student QR Code{% endblock %}


{% block nav_bar %}
<nav class="nav navbar navbar-expand-lg bg-white navbar-light iq-navbar">
  <div class="container-fluid navbar-inner">
    <a href="/admin-dashboard" class="navbar-brand">
      <!--Logo start-->
      <div class="logo-main">
        <div class="logo-normal">

        </div>
        <div class="logo-mini">

        </div>
      </div>
      <!--logo End-->
      <h4 class="logo-title">Campus Connect</h4>
    </a>
    <div class="sidebar-toggle" data-toggle="sidebar" data-active="true">
      <i class="icon">
        <svg width="20px" class="icon-20" viewBox="0 0 24 24">
          <path fill="currentColor" d="M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z" />
        </svg>
      </i>
    </div>
    <div class="input-group search-input mt-5">
    </div>
  </div>
</nav>
{% endblock %}

{% block main_bar %}
<div class="position-relative iq-banner">
  <div class="iq-navbar-header" style="height: 350px;">
    <div class="container-fluid iq-container">
      <div class="row">
        <div class="col-md-12">
          <div class="flex-wrap d-flex justify-content-between align-items-center  ">
            <div>
              <h1>CampusConnect - Bridging students and events</h1>
              <p>Connecting students with campus events, opportunities, and experiences in one place.</p>
            </div>
            <div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="iq-header-img h-70 ">
      <img src="/static/banner/hero.jpg" alt="header"
        class="theme-color-default-img img-fluid w-100 h-100 animated-scaleX">
    </div>
  </div>
</div>
{% endblock %}
{% block content %}
<div class="container-fluid content-inner mt-5 py-0">
  <div class="col-lg-6 bg-soft-info col-md-12">
    <div class="card ">
      <div class="card-header d-flex justify-content-between">
        <div class="header-title">
          <h4 class="card-title">Scan Student QR Code</h4>
        </div>
      </div>
      <div class="card-body">
        <div id="reader"></div>
        <div id="result"></div>
      </div>
    </div>
  </div>
</div>

<script>
  function onScanSuccess(qrMessage) {
    // Redirect to the verification route with UID
    window.location.href = `/verify/${qrMessage}`;
  }

  function onScanError(errorMessage) {
    // Handle scan errors
    console.warn(`QR Scan Error: ${errorMessage}`);
  }

  let scanner = new Html5QrcodeScanner("reader", {
    fps: 10,
    qrbox: 250
  });

  scanner.render(onScanSuccess, onScanError);
</script>

{% endblock %}